# 23 - Pentesting Telnet

{{#include ../banners/hacktricks-training.md}}


## **Información Básica**

Telnet es un protocolo de red que ofrece a los usuarios una forma NO segura de acceder a una computadora a través de una red.

**Puerto por defecto:** 23
```
23/tcp open  telnet
```
## **Enumeración**

### **Captura de Banners**
```bash
nc -vn <IP> 23
```
Toda la enumeración interesante se puede realizar con **nmap**:
```bash
nmap -n -sV -Pn --script "*telnet* and safe" -p 23 <IP>
```
El script `telnet-ntlm-info.nse` obtendrá información de NTLM (versiones de Windows).

Del [RFC de telnet](https://datatracker.ietf.org/doc/html/rfc854): En el Protocolo TELNET hay varias "**opciones**" que serán sancionadas y pueden ser utilizadas con la estructura "**DO, DON'T, WILL, WON'T**" para permitir que un usuario y un servidor acuerden usar un conjunto más elaborado (o quizás simplemente diferente) de convenciones para su conexión TELNET. Tales opciones podrían incluir cambiar el conjunto de caracteres, el modo de eco, etc.

**Sé que es posible enumerar estas opciones, pero no sé cómo, así que házmelo saber si sabes cómo.**

### [Fuerza bruta](../generic-hacking/brute-force.md#telnet)

## Archivo de configuración
```bash
/etc/inetd.conf
/etc/xinetd.d/telnet
/etc/xinetd.d/stelnet
```
## Comandos Automáticos de HackTricks
```
Protocol_Name: Telnet    #Protocol Abbreviation if there is one.
Port_Number:  23     #Comma separated if there is more than one.
Protocol_Description: Telnet          #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for t=Telnet
Note: |
wireshark to hear creds being passed
tcp.port == 23 and ip.addr != myip

https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-telnet.html

Entry_2:
Name: Banner Grab
Description: Grab Telnet Banner
Command: nc -vn {IP} 23

Entry_3:
Name: Nmap with scripts
Description: Run nmap scripts for telnet
Command: nmap -n -sV -Pn --script "*telnet*" -p 23 {IP}

Entry_4:
Name: consoleless mfs enumeration
Description: Telnet enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_version; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/brocade_enable_login; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_encrypt_overflow; set RHOSTS {IP}; set RPORT 23; run; exit' && msfconsole -q -x 'use auxiliary/scanner/telnet/telnet_ruggedcom; set RHOSTS {IP}; set RPORT 23; run; exit'

```
### Vulnerabilidades Recientes (2022-2025)

* **CVE-2024-45698 – Routers D-Link Wi-Fi 6 (DIR-X4860)**: El servicio Telnet integrado aceptaba credenciales codificadas y no sanitizaba la entrada, permitiendo RCE remota no autenticada como root a través de comandos manipulados en el puerto 23. Corregido en firmware ≥ 1.04B05.
* **CVE-2023-40478 – NETGEAR RAX30**: Desbordamiento de búfer basado en pila en el comando `passwd` de la CLI de Telnet permite a un atacante adyacente eludir la autenticación y ejecutar código arbitrario como root.
* **CVE-2022-39028 – GNU inetutils telnetd**: Una secuencia de dos bytes (`0xff 0xf7` / `0xff 0xf8`) provoca una desreferencia de puntero NULL que puede hacer que `telnetd` se bloquee, resultando en un DoS persistente después de varios bloqueos.

Ten en cuenta estos CVEs durante la triage de vulnerabilidades: si el objetivo está ejecutando un firmware sin parches o un daemon Telnet inetutils legado, puedes tener un camino directo hacia la ejecución de código o un DoS disruptivo.

### Captura de Credenciales y Hombre en el Medio

Telnet transmite todo, incluidas las credenciales, en **texto claro**. Dos formas rápidas de capturarlas:
```bash
# Live capture with tcpdump (print ASCII)
sudo tcpdump -i eth0 -A 'tcp port 23 and not src host $(hostname -I | cut -d" " -f1)'

# Wireshark display filter
tcp.port == 23 && (telnet.data || telnet.option)
```
Para MITM activo, combina el spoofing de ARP (por ejemplo, `arpspoof`/`ettercap`) con los mismos filtros de sniffing para recolectar contraseñas en redes conmutadas.

### Fuerza bruta automatizada / Pulverización de contraseñas
```bash
# Hydra (stop at first valid login)
hydra -L users.txt -P rockyou.txt -t 4 -f telnet://<IP>

# Ncrack (drop to interactive session on success)
ncrack -p 23 --user admin -P common-pass.txt --connection-limit 4 <IP>

# Medusa (parallel hosts)
medusa -M telnet -h targets.txt -U users.txt -P passwords.txt -t 6 -f
```
La mayoría de las botnets IoT (variantes de Mirai) aún escanean el puerto 23 con pequeños diccionarios de credenciales predeterminadas; reflejar esa lógica puede identificar rápidamente dispositivos débiles.

### Explotación y Post-Explotación

Metasploit tiene varios módulos útiles:

* `auxiliary/scanner/telnet/telnet_version` – enumeración de banner y opciones.
* `auxiliary/scanner/telnet/brute_telnet` – fuerza bruta multihilo.
* `auxiliary/scanner/telnet/telnet_encrypt_overflow` – RCE contra Telnet vulnerable de Solaris 9/10 (manejo de opción ENCRYPT).
* `exploit/linux/mips/netgear_telnetenable` – habilita el servicio telnet con un paquete elaborado en muchos enrutadores NETGEAR.

Después de obtener un shell, recuerda que **los TTYs suelen ser tontos**; actualiza con `python -c 'import pty;pty.spawn("/bin/bash")'` o usa los [trucos TTY de HackTricks](/generic-hacking/reverse-shells/full-ttys.md).

### Fortalecimiento y Detección (esquina del equipo azul)

1. Prefiere SSH y desactiva completamente el servicio Telnet.
2. Si se requiere Telnet, vincúlalo solo a VLANs de gestión, aplica ACLs y envuelve el demonio con TCP wrappers (`/etc/hosts.allow`).
3. Reemplaza las implementaciones heredadas de `telnetd` con `ssl-telnet` o `telnetd-ssl` para agregar cifrado de transporte, pero **esto solo protege los datos en tránsito—la adivinanza de contraseñas sigue siendo trivial**.
4. Monitorea el tráfico saliente al puerto 23; los compromisos a menudo generan shells inversos a través de Telnet para eludir filtros de salida HTTP estrictos.

## Referencias

* D-Link Advisory – CVE-2024-45698 RCE crítica de Telnet.
* NVD – CVE-2022-39028 inetutils `telnetd` DoS.

{{#include /banners/hacktricks-training.md}}
